package lab8;

/**
 * –ì–ª–∞–≤–Ω—ã–π –∫–ª–∞—Å—Å –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç—ã ‚Ññ8
 *
 * –ü—Ä–µ–¥—Å—Ç–∞–≤—å —ç—Ç–æ –∫–∞–∫ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –ø–æ —Å–±–æ—Ä–∫–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞:
 * 1. –°–æ–∑–¥–∞–µ–º –≤—Å–µ –¥–µ—Ç–∞–ª–∏ (–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã)
 * 2. –°–æ–±–∏—Ä–∞–µ–º –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä (—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã –≤ –º–µ–Ω–µ–¥–∂–µ—Ä–µ)
 * 3. –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
 * 4. –ó–∞–ø—É—Å–∫–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É
 * 5. –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
 */
public class Main {

    public static void main(String[] args) {
        // –ö—Ä–∞—Å–∏–≤–∞—è —à–∞–ø–∫–∞ –¥–ª—è –≤—ã–≤–æ–¥–∞
        System.out.println("‚ïê".repeat(70));
        System.out.println("  –õ–ê–ë–û–†–ê–¢–û–†–ù–ê–Ø –†–ê–ë–û–¢–ê ‚Ññ8: –ê–Ω–Ω–æ—Ç–∞—Ü–∏–∏ –∏ Stream API");
        System.out.println("  –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç–∏");
        System.out.println("‚ïê".repeat(70));

        // –®–ê–ì 1: –°–æ–∑–¥–∞–µ–º –º–µ–Ω–µ–¥–∂–µ—Ä –¥–∞–Ω–Ω—ã—Ö
        // –≠—Ç–æ –∫–∞–∫ –æ—Ç–∫—Ä—ã—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ
        DataManager manager = new DataManager();

        // –®–ê–ì 2: –°–æ–∑–¥–∞–µ–º –≤—Å–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö
        // –≠—Ç–æ –∫–∞–∫ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –≤—Å–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã
        FilterProcessor filterProcessor = new FilterProcessor();
        TransformProcessor transformProcessor = new TransformProcessor();
        AggregationProcessor aggregationProcessor = new AggregationProcessor();

        // –®–ê–ì 3: –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤ –º–µ–Ω–µ–¥–∂–µ—Ä–µ
        // –≠—Ç–æ –∫–∞–∫ –ø–æ–ª–æ–∂–∏—Ç—å –≤—Å–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –≤ —è—â–∏–∫ —Å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏
        System.out.println("\nüîß –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö:");
        manager.registerDataProcessor(filterProcessor);
        manager.registerDataProcessor(transformProcessor);
        manager.registerDataProcessor(aggregationProcessor);

        // –®–ê–ì 4: –ó–∞–≥—Ä—É–∂–∞–µ–º –∏—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ñ–∞–π–ª–∞
        // –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –Ω–∞ —Å–≤–æ–π
        String inputFile = "src/lab8/input_data.txt";
        manager.loadData(inputFile);

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
        System.out.println("\nüìä –ò–°–•–û–î–ù–´–ï –î–ê–ù–ù–´–ï:");
        manager.printData();

        // –®–ê–ì 5: –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ
        // –ó–¥–µ—Å—å –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤—Å—è –º–∞–≥–∏—è: –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –ø–æ –æ—á–µ—Ä–µ–¥–∏
        manager.processData();

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏
        System.out.println("\nüìä –†–ï–ó–£–õ–¨–¢–ê–¢ –û–ë–†–ê–ë–û–¢–ö–ò:");
        manager.printData();

        // –®–ê–ì 6: –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –Ω–æ–≤—ã–π —Ñ–∞–π–ª
        String outputFile = "src/lab8/output_data.txt";
        manager.saveData(outputFile);

        // –®–ê–ì 7: –ó–∞–≤–µ—Ä—à–∞–µ–º —Ä–∞–±–æ—Ç—É –º–µ–Ω–µ–¥–∂–µ—Ä–∞
        // –≠—Ç–æ –∫–∞–∫ –∑–∞–∫—Ä—ã—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É –∏ –æ—Å–≤–æ–±–æ–¥–∏—Ç—å —Ä–µ—Å—É—Ä—Å—ã
        manager.shutdown();

        System.out.println("\n‚ïê".repeat(70));
        System.out.println("  ‚úÖ –ü–†–û–ì–†–ê–ú–ú–ê –£–°–ü–ï–®–ù–û –ó–ê–í–ï–†–®–ï–ù–ê!");
        System.out.println("‚ïê".repeat(70));
    }
}
